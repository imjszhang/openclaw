# KL15: 必须实施"CLI 交互式引导”与"RPC 自动化构建”的双模式严格区分，以适配不同管理场景并保障构建流程的规范性

> 所属视角：P15-independent-agent
> 上层论点：必须实施"CLI 交互式引导”与"RPC 自动化构建”的双模式严格区分，并强制禁止跨 Agent 复用配置目录，以此构建人设与记忆的物理及逻辑双重隔离防线。

## 支撑论点

### 15.1: 基于五层架构的组合场景与层层递进的决策流，确立了从通道到人设的标准化构建路径

- 逻辑顺序：结构
- 引用 atoms: CQ-01, CQ-02
- 引用 groups: G29

系统支持按身份、平台、联系人等多维度拆分 Agent 场景，其核心设计遵循"Channel → Account → Agent → Bindings → Session → Workspace"的严格决策顺序。这种结构化的构建路径确保了不同管理场景下的配置逻辑清晰，为后续的人设隔离奠定了架构基础。

### 15.2: 长期记忆与私有配置的物理隔离机制，要求严禁跨 Agent 复用配置目录以保障数据独立性

- 逻辑顺序：程度
- 引用 atoms: CQ-03, CQ-04, CQ-05
- 引用 groups: G29

长期记忆存储于 Workspace 层，而认证信息与模型配置存储于 Agent 私有的 `agentDir` 中，两者在物理路径上完全分离。为避免配置冲突与功能失效，严禁在多个 Agent 间共享 `agentDir`，共享凭证时仅应手动复制 `auth-profiles.json` 文件而非整个目录。

### 15.3: 子 Agent 作为动态衍生的后台任务实例，通过 Session 隔离与受限权限实现安全的自动化执行

- 逻辑顺序：时间
- 引用 atoms: CQ-06, CQ-07, CQ-08, CQ-09, CQ-10
- 引用 groups: G29

子 Agent 是由主 Agent 通过 `sessions_spawn` 触发的临时衍生实例，而非独立实体，其在独立 Session 中运行并自动归档。它们共用主 Agent 的 Workspace 与配置目录，但拥有精简的系统提示与特定的 Lane 标识，且无法创建新的独立 Agent，从而确保了自动化构建过程中的逻辑边界。

### 15.4: 严格的文件操作权限控制与沙箱机制，防止 Agent 主动修改全局配置或非法创建新实体

- 逻辑顺序：程度
- 引用 atoms: CQ-11, CQ-12, CQ-13, CQ-14, CQ-15
- 引用 groups: G29

Agent 仅被允许在对话中修改 Workspace 内的人设与记忆文件，全局配置变更需用户明确请求且在沙箱模式下被移除写权限。由于缺乏 `agents.create` 工具权限且 `config.patch` 无法完整引导新 Agent 初始化，系统从机制上杜绝了 Agent 主动创建独立实体或破坏构建规范的可能性。

## 论点间关系

本 Key Line 遵循“架构定义 → 物理隔离 → 运行时机制 → 权限约束”的逻辑递进关系。首先确立标准化的构建场景与决策流，进而通过存储与配置的物理隔离夯实安全基础，随后详述子 Agent 的自动化衍生机制以适配 RPC 场景，最后通过严格的权限控制封堵违规操作路径，共同构建了双模式区分下的规范性防线。

---
