# KL11: 必须依据“时间精度需求”与“会话隔离要求”进行差异化选型与组合：高精度短周期任务采用会话内嵌 Heartbeat，低精度长周期任务采用网关层 Cron 分发，以此在确保会话隔离安全的同时实现高效自动化。

> 所属视角：P11-cron-heartbeat
> 上层论点：核心架构以本地优先网关为枢纽，通过五层抽象实现多渠道安全路由与上下文精准管理

## 支撑论点

### 11.1: 针对高精度、短周期的实时交互任务，应采用会话内嵌 Heartbeat 机制，利用 Lane 串行锁保障上下文连贯性与执行原子性

- 逻辑顺序：程度（高实时性/强一致性）
- 引用 atoms: CP-12, CP-19, CP-16
- 引用 groups: G28

该策略利用 `session:<key>` 车道的全局串行机制（CP-12, CP-19），确保心跳检测与工具执行在同一上下文桶（Context）内原子完成，避免并发写入导致的记忆状态冲突或上下文断裂。

### 11.2: 针对低精度、长周期的后台维护任务，应采用网关层 Cron 分发模式，通过独立车道解耦调度逻辑与会话状态以降低资源占用

- 逻辑顺序：程度（低实时性/弱耦合）
- 引用 atoms: CP-13, CP-19, AR-11
- 引用 groups: G15, G28

依托 Gateway 作为单一控制平面（AR-11, CP-13）的能力，将定时任务路由至独立的 `cron` 车道（CP-19），使其在不占用主对话会话锁的前提下异步执行，实现系统级资源的高效调度。

### 11.3: 混合场景下需严格遵循五层抽象隔离原则，防止 Cron 全局广播污染特定 Peer 的会话上下文，确保多租户环境下的数据安全

- 逻辑顺序：结构（架构层级约束）
- 引用 atoms: CP-07, CP-09, CP-15
- 引用 groups: G28

依据 `dmScope` 分桶策略（CP-07, CP-09）和广播组机制（CP-15），Cron 触发的 Agent 实例必须拥有独立的 Session 存储，严禁复用正在进行的用户对话上下文，从而在自动化执行中维持严格的会话隔离边界。

## 论点间关系

上述论点按照“任务实时性程度”递进排列：从需要强一致性锁的高频心跳（11.1），过渡到弱耦合的低频调度（11.2），最后通过架构隔离原则（11.3）为混合部署提供安全边界，共同构成完整的自动化时序管理方案。

---
