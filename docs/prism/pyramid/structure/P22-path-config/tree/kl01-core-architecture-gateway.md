# KL22: 路径配置必须通过环境变量或配置文件显式对齐 State 目录与 Workspace 目录的解析逻辑，严禁依赖隐式默认值，从而彻底规避 `ENOENT` 错误并保障架构一致性。

> 所属视角：P22-path-config
> 上层论点：核心架构以本地优先网关为枢纽，通过五层抽象实现多渠道安全路由与上下文隔离

## 支撑论点

### 22.1: 必须严格区分系统状态目录（State）与用户工作空间目录（Workspace）的物理存储与逻辑职能，防止配置与业务数据耦合。

- 逻辑顺序：结构
- 引用 atoms: CP-05, CP-06, AR-18
- 引用 groups: G28, G15

系统状态目录（默认为 `~/.openclaw`）专用于存储凭证、会话历史及系统配置，而工作空间目录（Workspace）则是 Agent 的唯一工作根目录（cwd），承载人设记忆（SOUL.md）、技能（skills/）及业务指令。混淆两者会导致系统在读取引导文件或持久化会话时发生路径解析错乱，进而引发文件丢失或权限冲突。

### 22.2: 路径解析链必须通过显式的环境变量或配置文件定义，以覆盖默认的隐式查找逻辑，确保多 Agent 部署下的目录隔离。

- 逻辑顺序：程度
- 引用 atoms: CP-10, CP-04, AR-20
- 引用 groups: G28

在多 Agent 架构中，严禁复用默认的 `agentDir` 或依赖隐式路径，必须为每个 Agent 实例显式指定独立的 Workspace 和 Auth 配置文件路径。若未显式对齐，不同 Agent 可能错误加载他人的技能包（Skills）或凭证（Auth-profiles），导致身份泄露或执行逻辑污染，破坏“本地优先”的安全边界。

### 22.3: 显式路径配置是规避 `ENOENT` 运行时错误及保障跨平台部署一致性的唯一可靠手段。

- 逻辑顺序：时间
- 引用 atoms: AR-08, AR-32, CP-02
- 引用 groups: G15, G28

从开发环境到生产部署（如 Docker、Raspberry Pi 或 VPS），文件系统的根目录结构往往存在差异，依赖隐式默认值极易在启动阶段因找不到 `AGENTS.md` 或 `sessions.json` 而抛出 `ENOENT` 错误。通过在启动前显式注入路径配置，可确保消息流转路径（Channel → Agent → Workspace）在任何资源约束环境下均能精准定位资源，保障架构的鲁棒性。

## 论点间关系

上述论点遵循“结构定义 → 配置实施 → 运行保障”的逻辑递进顺序：首先从架构层面厘清 State 与 Workspace 的职能边界，其次在部署阶段通过显式配置落实隔离策略，最终在运行时消除因路径不确定性导致的系统故障。

---
