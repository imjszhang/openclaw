# 序言设计（SCQA）

> 所属视角：P22-path-config

## 目标读者画像

| 维度     | 描述                                                                                                                   |
| -------- | ---------------------------------------------------------------------------------------------------------------------- |
| 角色     | OpenClaw 系统架构师、运维工程师及插件开发者                                                                            |
| 背景知识 | 熟悉 OpenClaw 的"本地优先网关"架构，了解 State 目录与 Workspace 目录在逻辑上的分离机制，有处理过文件路径解析错误的经验 |
| 核心诉求 | 彻底解决因默认路径解析逻辑不一致导致的 `ENOENT` 错误，确保系统在多环境下的配置稳定性与可维护性                         |

## S - 情境（Situation）

OpenClaw 系统基于"本地优先网关"核心架构，明确将状态数据（State）与工作空间（Workspace）在逻辑与物理存储上进行了分离设计。这种分离机制旨在保障数据隔离性与模块解耦，是系统长期稳定运行的基础前提。在标准部署中，这两类目录通常通过环境变量或配置文件进行显式定义。

## C - 冲突（Complication）

然而，在实际运行与跨组件调用中，State 目录与 Workspace 目录的默认解析逻辑往往存在隐式不一致，导致系统在查找资源时频繁抛出 `ENOENT`（文件或目录不存在）错误。这种路径对齐的缺失不仅引发运行时崩溃，更使得故障排查陷入对默认行为的盲目猜测，严重阻碍了系统的自动化诊断与平滑迁移。

## Q - 疑问（Question）

如何从架构配置层面显式对齐 State 与 Workspace 的解析逻辑，以根除因默认路径不一致引发的系统性错误？

## A - 答案（Answer）

路径配置必须通过环境变量或配置文件显式对齐 State 目录与 Workspace 目录的解析逻辑，严禁依赖隐式默认值，从而彻底规避 `ENOENT` 错误并保障架构一致性。

## 验证

- [x] S 是否是读者已有的共识？（是，分离机制是 OpenClaw 架构的基本事实）
- [x] C 是否自然地从 S 中产生？（是，分离设计若缺乏显式对齐，必然导致解析歧义与错误）
- [x] Q 是否是 C 的必然追问？（是，解决 `ENOENT` 错误的核心在于理清路径解析逻辑）
- [x] A 是否直接回答 Q？（是，提出了"显式对齐"的具体手段与目标）
- [x] A 是否与 synthesis 的顶层观点一致或有意调整？（是，完全对应 S26 观点："路径配置需显式对齐 State 目录与 Workspace 目录的解析逻辑...避免默认路径不一致导致的 ENOENT 错误"）

---

## 修订记录

| 日期       | 变更摘要                                          |
| ---------- | ------------------------------------------------- |
| 2026-02-26 | 首次设计，基于 S26 与 G38 提炼路径配置视角的 SCQA |
