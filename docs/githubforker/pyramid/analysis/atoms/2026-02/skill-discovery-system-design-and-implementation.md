# 日记：从「手动注册」到「Agent 自发现」— 为 js-eyes 构建技能发现与安装系统

> 来源：[../../../../journal/2026-02-26/skill-discovery-system-design-and-implementation.md](../../../../journal/2026-02-26/skill-discovery-system-design-and-implementation.md)
> 缩写：SD

## Atoms

| 编号  | 类型 | 内容                                                                                             | 原文定位                      |
| ----- | ---- | ------------------------------------------------------------------------------------------------ | ----------------------------- |
| SD-01 | 事实 | js-eyes 扩展技能安装原流程需用户手动复制路径、编辑 openclaw.json 并重启，易出错且 Agent 无法感知 | 起点：扩展技能的安装痛点      |
| SD-02 | 判断 | 主插件代注册方案违背 OpenClaw「一插件一注册」原则，且导致子技能配置透传困难                      | 思考：六个方案的比较          |
| SD-03 | 判断 | 安装脚本自动注册方案虽零侵入但仅为一次性操作，新增子技能需重新安装或手动更新                     | 思考：六个方案的比较          |
| SD-04 | 经验 | 最终架构选择 GitHub Pages 静态注册表方案，核心考量是不依赖上游改动、Agent 友好且利用现有基础设施 | 思考：六个方案的比较          |
| SD-05 | 事实 | 技能发现体系分为四层：skills.json 静态注册表、独立 zip 包、安装脚本、OpenClaw AI 工具            | 架构设计：四层发现体系        |
| SD-06 | 步骤 | 构建流程需新增 YAML Frontmatter 解析器、子技能发现函数、子技能打包函数及注册表生成函数           | 落地实施：四个任务的完整过程  |
| SD-07 | 步骤 | install.sh 支持通过参数指定子技能 ID，从 skills.json 解析下载 URL 并自动解压安装                 | 落地实施：四个任务的完整过程  |
| SD-08 | 步骤 | install.ps1 因管道执行限制，需新增函数或通过环境变量 JS_EYES_SKILL 触发子技能安装                | 落地实施：四个任务的完整过程  |
| SD-09 | 事实 | js_eyes_discover_skills 工具通过 HTTP 获取注册表并检查本地目录判断安装状态                       | 落地实施：四个任务的完整过程  |
| SD-10 | 步骤 | js_eyes_install_skill 工具执行流程包含下载 zip、跨平台解压、npm install 及自动写入 openclaw.json | 落地实施：四个任务的完整过程  |
| SD-11 | 经验 | 自定义 YAML 解析器中，栈弹出条件应为 indent < stack.top.indent，使用<=会导致同级节点被错误弹出   | 踩的坑：YAML 解析器的缩进 Bug |
| SD-12 | 事实 | skills.json 注册表由 skills/\*/SKILL.md 的 YAML frontmatter 自动生成，作为系统唯一真相来源       | 思考与复盘                    |
| SD-13 | 经验 | 自动化流程必须保留清晰的手动执行路径作为信任基础，而非仅作为兜底方案                             | 思考与复盘                    |
| SD-14 | 判断 | 从网站入手优于内部方案，因为静态 JSON 文件可同时服务于 Agent、人类用户和网页访问者               | 思考与复盘                    |
